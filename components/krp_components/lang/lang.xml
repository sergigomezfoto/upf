<krpano>

<style name="lang_cont"
    type="container"
    align="topright"
    width="102px"
    height="30px"
    edge="topright"
    y="get:margins.top"
    x="get:margins.right"   
    bgcapture="true"
    capture="false"
    onclick="choose_lang"
    bgcolor="0x654ff54"
    bgalpha="0"
/>

    <action name="choose_lang" scope="local">
        lt=layer[lang_cont_triangle];
        ls=layer[lang_sub_container];
        if (lt.rotate == 0,
            lt.rotate="180";
            lt.edge="left";
            tween(ls.y, calc(margins.top + 30), 0.2);
            tween(ls.alpha, 1, 0.3);
            ,
            lt.rotate="0";
            lt.edge="right";
            tween(ls.y,calc(margins.top + 20), 0.3);
            tween(ls.alpha,0, 0.2);
        );
    </action>

    <style name="lang_cont_ico"
        url="%FIRSTXML%/assets/img/lang_world.png"
        align="left" 
        enabled="false" 
        capture="false" 
    />

    <style name="lang_cont_text"
        type="text"
        x="3px"
        align="center"
        bg="false"
        bgcolor="0x654ff54"
        css="font-family:'lota_regular';font-size:13px;color:#ffffff;text-align:center;text-transform: uppercase;"  
        enabled="false"     
        capture="false" 
    />

    <style name="lang_cont_triangle"
        url="%FIRSTXML%/assets/img/lang_triangle.png"
        align="right" 
        enabled="false"
        capture="false" 
    />

<style name="lang_sub_container"
    type="container"
    align="righttop"
    width="102px"
    height="40px"
    y="calc:margins.top + 20"
    x="get:margins.right"   
    bgcapture="true"
    capture="false"
    bgcolor="0xff5498"
    bgalpha="0"
    enablechildren="true"
    autoalpha="true"
    alpha="0"

/>

    <style name="lang_sub"
        type="text"
        x="3px"
        align="top"
        bg="false"
        bgcolor="0x654ff54"
        css="font-family:'lota_regular';font-size:13px;color:#ffffff;text-align:center;text-transform: uppercase;"  
        alpha="0.6"    
        autoalpha="true"   
        onover="set(alpha, 1);"
        onout="set(alpha, 0.6);"
        onclick="change_lang"
        capture="false" 
    />

<layer name="lang_cont" keep="true" style="lang_cont">
    <layer name="lang_cont_ico" keep="true" style="lang_cont_ico"/>
    <layer name="lang_cont_text" keep="true" style="lang_cont_text" text="get:lang.main"/>
    <layer name="lang_cont_triangle" keep="true" style="lang_cont_triangle"/>
</layer>
<layer name="lang_sub_container" keep="true" style="lang_sub_container">
    <layer name="lang_sub1" keep="true" style="lang_sub" text="get:lang.sub1"/>
    <layer name="lang_sub2" keep="true" style="lang_sub" text="get:lang.sub2" y="25px"/>
</layer>

// TODO CANVI IDIOMA

<action name="change_lang">

   if (text === 'CATALÀ',
    language='ca';
    ,text === 'ESPAÑOL',
    language='es';
    ,text === 'ENGLISH',
    language='en';
   );
   includexml('%FIRSTXML%/config/config.xml', hot_reload(););

</action>
<action name="hot_reload">
//lang component
layer[lang_cont_text].text=lang.main;
layer[lang_sub1].text=lang.sub1;
layer[lang_sub2].text=lang.sub2;
callwith(layer[lang_cont],'onclick');

//info_panel component
info_panel_action();

//cta component
layer[cta_1].text=ui.cta_1;
layer[cta_2].text=ui.cta_2;

//menu component
callwith(layer[titol_campus_balmes],"menu_items_text('titol_campus_balmes')");
callwith(layer[titol_campus_ciutadella],"menu_items_text('titol_campus_ciutadella')");
callwith(layer[bs1],"menu_items_text('scom')");
callwith(layer[bs2],"menu_items_text('scla')");
callwith(layer[cs1],"menu_items_text('scom')");
callwith(layer[cs2],"menu_items_text('scla')");
forall(layer,l,
    if(contains(l.name,'menulayer'),
        callwith(l, "menu_items_text('t')");
    );
);
//bottom line component
layer[bottom_line_text_politica].text=ui.politica;
layer[bottom_line_text_guide].text=ui.guide;
//js-krpano data
jscall(jsUiText(););


//hotspots
forall(hotspot, h,
   if (!contains(h.name,'title') AND !contains(h.name,'preview'),
    trace(data[(h.name)].content);
    trace(data[b_02_title].content);
    trace(hotspot[(h.name + 'title')].text);
    calc(hotspot[(h.name + 'title')].text,(data[(h.name)].content));
   );
);

</action>

</krpano>
